<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.hachimiSys.mapper.RescueCaseMapper">
    
    <resultMap type="RescueCase" id="RescueCaseResult">
        <result property="caseId"    column="case_id"    />
        <result property="title"    column="title"    />
        <result property="petId"    column="pet_id"    />
        <result property="content"    column="content"    />
        <result property="rescueCost"    column="rescue_cost"    />
        <result property="status"    column="status"    />
        <result property="publishTime"    column="publish_time"    />
        <result property="createUserId"    column="create_user_id"    />
        <result property="viewCount"    column="view_count"    />
        <result property="hidden"    column="hidden"    />
    </resultMap>

    <sql id="selectRescueCaseVo">
        select case_id, title, pet_id, content, rescue_cost, status, publish_time, create_user_id, view_count, hidden from rescue_case
    </sql>

    <select id="selectRescueCaseList" parameterType="RescueCase" resultMap="RescueCaseResult">
        <include refid="selectRescueCaseVo"/>
        <where>  
            <if test="title != null  and title != ''"> and title like concat('%', #{title}, '%')</if>
        </where>
    </select>
    
    <select id="selectRescueCaseByCaseId" parameterType="Long" resultMap="RescueCaseResult">
        <include refid="selectRescueCaseVo"/>
        where case_id = #{caseId}
    </select>

    <insert id="insertRescueCase" parameterType="RescueCase" useGeneratedKeys="true" keyProperty="caseId">
        insert into rescue_case
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="title != null and title != ''">title,</if>
            <if test="petId != null">pet_id,</if>
            <if test="content != null">content,</if>
            <if test="rescueCost != null">rescue_cost,</if>
            <if test="status != null">status,</if>
            <if test="publishTime != null">publish_time,</if>
            <if test="createUserId != null">create_user_id,</if>
            <if test="viewCount != null">view_count,</if>
            <if test="hidden != null">hidden,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="title != null and title != ''">#{title},</if>
            <if test="petId != null">#{petId},</if>
            <if test="content != null">#{content},</if>
            <if test="rescueCost != null">#{rescueCost},</if>
            <if test="status != null">#{status},</if>
            <if test="publishTime != null">#{publishTime},</if>
            <if test="createUserId != null">#{createUserId},</if>
            <if test="viewCount != null">#{viewCount},</if>
            <if test="hidden != null">#{hidden},</if>
         </trim>
    </insert>

    <update id="updateRescueCase" parameterType="RescueCase">
        update rescue_case
        <trim prefix="SET" suffixOverrides=",">
            <if test="title != null and title != ''">title = #{title},</if>
            <if test="petId != null">pet_id = #{petId},</if>
            <if test="content != null">content = #{content},</if>
            <if test="rescueCost != null">rescue_cost = #{rescueCost},</if>
            <if test="status != null">status = #{status},</if>
            <if test="publishTime != null">publish_time = #{publishTime},</if>
            <if test="createUserId != null">create_user_id = #{createUserId},</if>
            <if test="viewCount != null">view_count = #{viewCount},</if>
            <if test="hidden != null">hidden = #{hidden},</if>
        </trim>
        where case_id = #{caseId}
    </update>

    <delete id="deleteRescueCaseByCaseId" parameterType="Long">
        delete from rescue_case where case_id = #{caseId}
    </delete>

    <delete id="deleteRescueCaseByCaseIds" parameterType="String">
        delete from rescue_case where case_id in 
        <foreach item="caseId" collection="array" open="(" separator="," close=")">
            #{caseId}
        </foreach>
    </delete>
</mapper>