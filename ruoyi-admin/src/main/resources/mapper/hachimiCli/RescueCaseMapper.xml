<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.hachimiCli.mapper.RescueCaseMapper_Cli">

    <resultMap type="CaseAndImgDto" id="CaseAndImgDtoResult">
        <result property="caseId"    column="case_id"    />
        <result property="title"    column="title"    />
        <result property="content"    column="content"    />
        <result property="rescueCost"    column="rescue_cost"    />
        <result property="status"    column="status"    />
        <result property="nickname"    column="nickname"    />
        <result property="viewCount"    column="view_count"    />
        <result property="imageUrl"    column="image_url"    />
        <result property="petName"    column="pet_name"    />
        <result property="rescuePlace"    column="rescue_place"    />
        <result property="publishTime"    column="publish_time"    />
    </resultMap>

    <select id="selectCaseAndImgDto" parameterType="Long" resultMap="CaseAndImgDtoResult">
        SELECT
        `c`.`case_id`,
        `c`.`title`,
        `c`.`content`,
        `c`.`rescue_cost`,
        `c`.`status`,
        `u`.`nickname`,
        `c`.`view_count`,
        `i`.`image_url`,
        `p`.`pet_name`,
        `p`.`rescue_place`,
        `c`.`publish_time`
        FROM `rescue_case` AS `c`
        JOIN `user` AS `u` ON `c`.`create_user_id` = `u`.`user_id`
        JOIN `pet` AS `p` ON `c`.`pet_id` = `p`.`pet_id`
        JOIN `case_image` AS `i` ON `c`.`case_id` = `i`.`case_id`
        WHERE `u`.`user_id` = #{userId}
        AND `c`.`hidden` = '0'
        AND `p`.`hidden` = '0'
        AND `i`.`hidden` = '0'
    </select>

</mapper>